<!-- <script>

    // Tarjetas de contactos
    function crearTarjetaContactos() {

        limpiar();


        google.script.run
            .withSuccessHandler(crearTarjetassCorrectamente)
            .withFailureHandler(crearTarjetasError)
            .obtenerDatos();


    }

    function crearTarjetasError() {

        // Mostrar notificación de error
        crearNotificacionError("No se han podido obtener los datos", "ERROR");

        // eliminar loader
        eliminarLoader();
    }

    function crearTarjetasCorrectamente(datos) {

        // extraer contactos
        let contactos = extraerContactos(datos);

        // eliminarLoader();
        let tarjetas = document.createElement("div");
        tarjetas.id = "tarjetasContactos";
        tarjetas.classList.add("container");

        // por cada contacto agregamos una tarjeta

        contactos.forEach(contacto => tarjetas.appendChild(crearContactoTarjeta(contactos))

            // agregar tarjeta al contenedor
            tarjetas.appendChild(crearTarjeta(datos);

            );
        
        // agregar las tarjetas a la página

        document.getElementById("divContactos").appendChild(tarjetas);


        // eliminar loader
        eliminarLoader();

    }

    function crearContactoTarjeta(contacto) {
        let divTarjeta = document.createElement("div");
        divTarjeta.id = 'tarjeta' + contacto.indice;
        divTarjeta.classList.add("row", "border", "border-3", "border-dark", "rounded", "m-3", "p-3");


        // creamos datos y botones

        let datosTarjeta = crearContactoTarjeta(contacto);
        let divBotones = crearBotonesTarjeta(contacto);
        datosTarjeta.appendChild(divBotones);

        // creamos imagen
        let imagenTarjeta = crearImagenTarjeta(contacto);

        // agregamos todo al divTarjeta
        divTarjeta.appendChild(datosTarjeta);
        divTarjeta.appendChild(imagenTarjeta);

        return divTarjeta;

    }

    function crearDatosTarjeta(contacto) {

        let datosTarjeta = document.createElement("div");
        datosTarjeta.classList.add("col-6", 'd-flex', 'flex-column', 'align-items-start');

        // nombre 
        let nombre = document.createElement("h3");
        nombre.textContent = contacto.nombre + ' ' + contacto.apellidos;


        // correo
        let correo = document.createElement("div");
        correo.classList.add("d-flex");
        let iconoCorreo = document.createElement("i");
        iconoCorreo.classList.add("bi", "bi-envelope-fill", "me-2");
        let tituloCorreo = document.createElement("h5");
        tituloCorreo.textContent = contacto.correo;
        correo.appendChild(iconoCorreo);
        correo.appendChild(tituloCorreo);

        // teléfono
        let telefono = document.createElement("div");
        telefono.classList.add("d-flex", "mt-2");
        let iconoTelefono = document.createElement("i");
        iconoTelefono.classList.add("bi", "bi-telephone-fill", "me-2");
        let tituloTelefono = document.createElement("h5");
        tituloTelefono.textContent = contacto.telefono;
        telefono.appendChild(iconoTelefono);
        telefono.appendChild(tituloTelefono);


        // agregar todo a datosTarjeta

        datosTarjeta.appendChild(nombre);
        datosTarjeta.appendChild(correo);
        datosTarjeta.appendChild(telefono);

        return datosTarjeta;

    }

    function crearBotonesTarjeta(contacto) {

        // crear div botones
        let divBotones = document.createElement("div");
        divBotones.classList.add("d-flex", "justify-content-start", "mt-auto");

        // 
        let botonInfo = crearBotonInfoContacto(contacto);
        let botonBorrar = crearBotonBorrarContacto(contacto);
        let botonModificar = crearBotonContacto(contacto);

        // agregar botones al div
        divBotones.appendChild(botonInfo);
        divBotones.appendChild(botonBorrar);
        divBotones.appendChild(botonModificar);

        return divBotones;

    }

    

    function crearImagenTarjeta(contacto) {

        let imagenTarjeta = document.createElement("div");
        imagenTarjeta.classList.add("col-6", "d-flex","justify-content-end");
        let cajaImagenTarjeta = document.createElement("div");
        cajaImagenTarjeta.classList.add("box", "border", "border-3", "border-dark", "rounded");
        let imagen = document.createElement("img");
        imagen.classList.add("img-fluid", "rounded", "img-contacto");
        imagen.src = contacto.imagen;

        // agregar imagen a la caja
        cajaImagenTarjeta.appendChild(imagen);
        imagenTarjeta.appendChild(cajaImagenTarjeta);

        return imagenTarjeta;

    }


    function mostrarInformacionAdicionalContacto(tarjeta) {

    }



    function eliminarTarjetas() {
        let tarjetas = document.getElementById("tarjetasContactos");
        if (tarjetas) {
            tarjetas.remove();
        }
    }


</script> -->

<script>
    // Tarjetas de contactos
    function crearTarjetaContactos() {
        // Asegúrate de tener definida la función limpiar() o usa eliminarTarjetas()
        eliminarTarjetas(); 
        crearLoaderPuntos("divContactos");

        google.script.run
            .withSuccessHandler(crearTarjetasCorrectamente) // Nombre corregido
            .withFailureHandler(crearTarjetasError)
            .obtenerDatos(); // Asegúrate de que en el servidor se llama así
    }

    function crearTarjetasError() {
        crearNotificacionError("No se han podido obtener los datos", "ERROR");
        eliminarLoader();
    }

    function crearTarjetasCorrectamente(datos) {

        let contactos = extraerContactos(datos);

        let tarjetas = document.createElement('div');
        tarjetas.id = 'tarjetasContactos';
        tarjetas.classList.add('container');

        // por cada contacto, agregamos una tarjeta

        contactos.forEach(contacto =>tarjetas.appendChild(crearContactoTarjeta(contacto)));


        // agregar tarjetas
        document.getElementById('divContactos').appendChild(tarjetas);

        // eliminar el loader
        eliminarLoader();




    }

    function crearContactoTarjeta(contacto) {
        let divTarjeta = document.createElement("div");
        divTarjeta.id = 'tarjeta' + contacto.fila;
        divTarjeta.classList.add("row", "border", "border-3", "border-dark", "rounded", "m-3", "p-3", "bg-light");

        let datosTarjeta = crearDatosTarjeta(contacto);
        let imagenTarjeta = crearImagenTarjeta(contacto);

        // Agregamos imagen primero y luego datos (o al revés según tu diseño)
        divTarjeta.appendChild(datosTarjeta);
        divTarjeta.appendChild(imagenTarjeta);

        return divTarjeta;
    }

    function crearDatosTarjeta(contacto) {
        let datosDiv = document.createElement("div");
        datosDiv.classList.add("col-6", 'd-flex', 'flex-column', 'align-items-start');

        // Nombre (USANDO 'contacto' no 'tarjeta')
        let nombre = document.createElement("h3");
        nombre.textContent = contacto.nombre + ' ' + contacto.apellidos;

        // Correo 
        let correoDiv = document.createElement("div");
        correoDiv.classList.add("d-flex", "align-items-center");
        correoDiv.innerHTML = `<i class="bi bi-envelope-fill me-2"></i><h5>${contacto.correo}</h5>`;

        // Teléfono
        let telDiv = document.createElement("div");
        telDiv.classList.add("d-flex", "align-items-center", "mt-2");
        telDiv.innerHTML = `<i class="bi bi-telephone-fill me-2"></i><h5>${contacto.telefono}</h5>`;

        // Botones
        let divBotones = crearBotonesTarjeta(contacto);

        datosDiv.appendChild(nombre);
        datosDiv.appendChild(correoDiv);
        datosDiv.appendChild(telDiv);
        datosDiv.appendChild(divBotones);

        return datosDiv;
    }

function crearBotonesTarjeta(contacto) {
        let divBotones = document.createElement("div");
        divBotones.classList.add("d-flex", "justify-content-start", "mt-auto", "gap-2");

        // Botones básicos para que no de error
        divBotones.appendChild(crearBotonInfoContacto(contacto));
        divBotones.appendChild(crearBotonBorrarContacto(contacto));
        divBotones.appendChild(crearBotonModificarContacto(contacto));

        return divBotones;
    }
 
    function crearImagenTarjeta(contacto) {
       
        let divTarjeta = document.createElement("div");
        divTarjeta.classList.add("col-6", "d-flex", "justify-content-end", "align-items-center");
        
        let cajaImagenTarjeta = document.createElement("div");
        cajaImagenTarjeta.classList.add("box","border","border-3","border-dark","rounded");

        let imagenTarjeta = document.createElement('img');
        imagenTarjeta.classList.add('img-fluid','rounded','img-contacto');
        imagenTarjeta.src = contacto.imagen;

        cajaImagenTarjeta.appendChild(imagenTarjeta);
        divTarjeta.appendChild(cajaImagenTarjeta);

        return divTarjeta;
    }

    function eliminarTarjetas() {
        let tarjetas = document.getElementById("tarjetasContactos");
        if (tarjetas) tarjetas.remove();
    }
</script>